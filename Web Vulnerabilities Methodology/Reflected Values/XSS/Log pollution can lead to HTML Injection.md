### 漏洞描述

1.  **漏洞类型**：存储型 XSS
2.  **漏洞位置**：应用的日志部分，该日志文件由管理员访问并下载。
3.  **漏洞机制**：攻击者通过操纵 HTTP 请求头（例如 `Host` 头）插入恶意 HTML 代码。当应用记录这些请求并生成日志文件时，恶意代码被包含在日志文件中。管理员下载并打开该日志文件时，恶意代码在管理员的浏览器中执行。

### 漏洞复现步骤

1.  发送特制的 HTTP 请求，其中包含恶意的 `Host` 头：
    
    ```http
    GET /nextcloud/index.php HTTP/1.1
    Host: -->test"<img src=a onerror=alert('xss')>
    ```
    
2.  管理员下载日志文件。
3.  打开日志文件，观察到嵌入的恶意代码被执行。

### 漏洞影响

此漏洞允许攻击者通过诱使管理员下载并打开日志文件来执行任意代码。这可能导致敏感信息泄露、进一步系统入侵或其他恶意行为。

### 原文
https://hackerone.com/reports/146278
